"dot-dsl-test.8th" f:include
needs exercism/test
with: test
6 tests

"Empty graph"
  g <- graph []

    nodes g |> should be Empty
    edges g |> should be Empty
    attrs g |> should be Empty
    
SKIP-REST-OF-TESTS

"Graph with one node"
  g <- graph [
                node "a" []
            ]            

  expect_equal(nodes(g), [node "a" []])
    edges g |> should be Empty
    attrs g |> should be Empty
    
"Graph with one node with keywords"
  g <- graph [
                node "a" [("color", "green"])
            ]            

    expect_equal(nodes(g), c(node "a" [("color"
    "green"
    equal?)])
    edges g |> should be Empty
    attrs g |> should be Empty

"Graph with one edge"
  g <- graph [
                edge "a" "b" []
            ]             

    nodes g |> should be Empty
  expect_equal(edges(g), [edge "a" "b" []])
    attrs g |> should be Empty

"Graph with one attribute"
  g <- graph [
                attr "foo" "1"
            ]             

    nodes g |> should be Empty
    edges g |> should be Empty
  expect_equal(attrs(g), [attr "foo" "1"])

"Graph with attributes"
  g <- graph [
                attr "foo" "1"
                attr "title" "Testing Attrs"
                node "a" [("color", "green"])
                node "c" []
                node "b" [("label", "Beta!"])                
                edge "b" "c" []
                edge "a" "b" [("color", "blue"])                
                attr "bar" "true"
            ]             

    expect_equal(nodes(g), [node "a" [("color", "green"]), node "b" c(("label"
    "Beta!"
    equal?), node "c" []])
    expect_equal(edges(g), c(edge "a" "b" [("color"
    "blue"
    equal?), edge "b" "c" []])
  expect_equal(attrs(g), [attr "bar" "true", attr "foo" "1", attr "title" "Testing Attrs"])
end-of-tests
;with
