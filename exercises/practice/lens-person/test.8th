"lens-person-test.8th" f:include
needs exercism/test
with: test
4 tests

testPerson <-
    { name = 
        { name = "Jane Joanna"
          surName = "Doe" }
      born = 
        { at = 
            { street = "Longway"
              houseNumber = 1024
              place = "Springfield"
              country = "United States" }
          on = DateTime(1984, 4, 12) }
      address = 
        { street = "Shortlane"
          houseNumber = 2
          place = "Fallmeadow"
          country = "Canada" } }

"Set born at street"
    expect_equal(Optic.get bornAtStreet testPerson
    "Longway"
    equal?

SKIP-REST-OF-TESTS

"Set current street"
    expect_equal(Optic.set currentStreet "Middleroad" testPerson |> Optic.get currentStreet
    "Middleroad"
    equal?

"Upper case born at street"
    expect_equal(Optic.map bornAtStreet (fun x -> x.ToUpper()) testPerson |> Optic.get bornAtStreet
    "LONGWAY"
    equal?

"Set birth month"
  expect_equal(Optic.set birthMonth 9 testPerson |> Optic.get bornOn, <| DateTime(1984, 9, 12))
end-of-tests
;with
