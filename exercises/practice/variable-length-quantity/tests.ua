~ "variable-length-quantity.ua" ~ VariableLengthQuantity

# Zero
    encode [0x0u] |> should equal [0x0uy]

# Arbitrary single byte
    encode [0x40u] |> should equal [0x40uy]

# Largest single byte
    encode [0x7fu] |> should equal [0x7fuy]

# Smallest double byte
    encode [0x80u] |> should equal [0x81uy 0x0uy]

# Arbitrary double byte
    encode [0x2000u] |> should equal [0xc0uy 0x0uy]

# Largest double byte
    encode [0x3fffu] |> should equal [0xffuy 0x7fuy]

# Smallest triple byte
    encode [0x4000u] |> should equal [0x81uy 0x80uy 0x0uy]

# Arbitrary triple byte
    encode [0x100000u] |> should equal [0xc0uy 0x80uy 0x0uy]

# Largest triple byte
    encode [0x1fffffu] |> should equal [0xffuy 0xffuy 0x7fuy]

# Smallest quadruple byte
    encode [0x200000u] |> should equal [0x81uy 0x80uy 0x80uy 0x0uy]

# Arbitrary quadruple byte
    encode [0x8000000u] |> should equal [0xc0uy 0x80uy 0x80uy 0x0uy]

# Largest quadruple byte
    encode [0xfffffffu] |> should equal [0xffuy 0xffuy 0xffuy 0x7fuy]

# Smallest quintuple byte
    encode [0x10000000u] |> should equal [0x81uy 0x80uy 0x80uy 0x80uy 0x0uy]

# Arbitrary quintuple byte
    encode [0xff000000u] |> should equal [0x8fuy 0xf8uy 0x80uy 0x80uy 0x0uy]

# Maximum 32-bit integer input
    encode [0xffffffffu] |> should equal [0x8fuy 0xffuy 0xffuy 0xffuy 0x7fuy]

# Two single-byte values
    encode [0x40u 0x7fu] |> should equal [0x40uy 0x7fuy]

# Two multi-byte values
    encode [0x4000u 0x123456u] |> should equal [0x81uy 0x80uy 0x0uy 0xc8uy 0xe8uy 0x56uy]

# Many multi-byte values
    encode [0x2000u 0x123456u 0xfffffffu 0x0u 0x3fffu 0x4000u] |> should equal [0xc0uy 0x0uy 0xc8uy 0xe8uy 0x56uy 0xffuy 0xffuy 0xffuy 0x7fuy 0x0uy 0xffuy 0x7fuy 0x81uy 0x80uy 0x0uy]

# One byte
    decode [0x7fuy] |> should equal (Some [0x7fu])

# Two bytes
    decode [0xc0uy 0x0uy] |> should equal (Some [0x2000u])

# Three bytes
    decode [0xffuy 0xffuy 0x7fuy] |> should equal (Some [0x1fffffu])

# Four bytes
    decode [0x81uy 0x80uy 0x80uy 0x0uy] |> should equal (Some [0x200000u])

# Maximum 32-bit integer
    decode [0x8fuy 0xffuy 0xffuy 0xffuy 0x7fuy] |> should equal (Some [0xffffffffu])

# Incomplete sequence causes error
    decode [0xffuy] |> should equal None

# Incomplete sequence causes error, even if value is zero
    decode [0x80uy] |> should equal None

# Multiple values
    decode [0xc0uy 0x0uy 0xc8uy 0xe8uy 0x56uy 0xffuy 0xffuy 0xffuy 0x7fuy 0x0uy 0xffuy 0x7fuy 0x81uy 0x80uy 0x0uy] |> should equal (Some [0x2000u 0x123456u 0xfffffffu 0x0u 0x3fffu 0x4000u])

